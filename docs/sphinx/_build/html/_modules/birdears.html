
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>birdears &#8212; birdears 0.2.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/hljs_styles/monokai.css" type="text/css" />
  <script type="text/javascript" src="../_static/js/highlight.pack.js"></script>
  <script src="https://cdn.rawgit.com/iacchus/abcjs/master/bin/abcjs_plugin_3.1.2-hotfix-min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
  $(document).ready(function() {
    $('.highlight-none pre').each(function(i, block) {
      hljs.highlightBlock(block);
    });
    $('.highlight pre').each(function(i, block) {
      hljs.highlightBlock(block);
    });
  });
</script>

<script>
  abcjs_plugin_autostart = false;
  window.ABCJS.plugin.auto_render = false;

$(document).ready(function(){
  function is_it_abc(elem) {
    if(window.ABCJS.plugin.getABCContainingElements(elem).length) return true;
    else return false;
  }

  if($(".highlight-abc pre").length)
  {
    var tunes_code = $(".highlight-abc pre");
			
    for(var $i=0; tunes_code[$i]; $i++)
    {               
      if(! is_it_abc($(tunes_code[$i]))) continue;

      var ws_strip="";
      var mystr="";

      ws_strip = $(tunes_code[$i]).text().split('\n');
      for(var aaa=0; ws_strip[aaa]; aaa++) { mystr+=ws_strip[aaa].trim() + "\n"; }

      $(tunes_code[$i]).text(mystr); //abctune

      $('<div id="abctune-' + $i + '" class="abctune-rendered"></div>').insertBefore($(tunes_code[$i]).parent());
      ABCJS.renderAbc(
        "abctune-"+$i, //container
        "%%staffsep 27pt\n" + $(tunes_code[$i]).text(), //abctune
        { }, //parserParams
        {
          scale: 1,
          staffwidth:600,
          paddingtop: 0,
          paddingbottom: 0,
          paddingright: 0,
          paddingleft: 0,
        }, //engraverParams
        { viewportHorizontal: true } //renderParams
      );
      $(tunes_code[$i]).parent().hide();
    }
  }

  if($("code.abckeep").length)
  {
    var tunes_code = $("code.abckeep");
			
    for(var $i=0; tunes_code[$i]; $i++)
    {               
      if(! is_it_abc($(tunes_code[$i]))) continue;

      var ws_strip="";
      var mystr="";

      ws_strip = $(tunes_code[$i]).text().split('\n');
      for(var aaa=0; ws_strip[aaa]; aaa++) { mystr+=ws_strip[aaa].trim() + "\n"; }

      $(tunes_code[$i]).text(mystr); //abctune

      $('<div id="abctunekeep-' + $i + '" class="abctune-rendered"></div>').insertBefore($(tunes_code[$i]).parent());
      ABCJS.renderAbc(
        "abctunekeep-"+$i, //container
        "%%staffsep 27pt\n"+$(tunes_code[$i]).text(), //abctune
        { }, //parserParams
        {
          scale: 1,
          staffwidth:700,
          paddingtop: 0,
          paddingbottom: 0,
          paddingright: 0,
          paddingleft: 0,
        }, //engraverParams
        { viewportHorizontal: true } //renderParams
      );
      $(tunes_code[$i]).parent().css({marginTop:0})
      //$(tunes_code[$i]).hide();
    }
  }
})
</script>
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for birdears</h1><div class="highlight"><pre>
<span></span>&quot;&quot;&quot;
birdears provides facilities to building musical ear training exercises.
&quot;&quot;&quot;


<div class="viewcode-block" id="D"><a class="viewcode-back" href="../index.html#birdears.D">[docs]</a>def D(data, nlines=0):

    lb = &#39;\n&#39; * nlines
    with open(&#39;dbg_pipe&#39;, &#39;w&#39;) as debug_pipe:
        debug_pipe.write(str(data) + lb)</div>


CHROMATIC_SHARP = (&#39;C&#39;, &#39;C#&#39;, &#39;D&#39;, &#39;D#&#39;, &#39;E&#39;, &#39;F&#39;, &#39;F#&#39;, &#39;G&#39;, &#39;G#&#39;, &#39;A&#39;, &#39;A#&#39;,
                   &#39;B&#39;)
&quot;&quot;&quot;tuple: Chromatic notes names using sharps.

A mapping of the chromatic note namesu sing sharps&quot;&quot;&quot;

CHROMATIC_FLAT = (&#39;C&#39;, &#39;Db&#39;, &#39;D&#39;, &#39;Eb&#39;, &#39;E&#39;, &#39;F&#39;, &#39;Gb&#39;, &#39;G&#39;, &#39;Ab&#39;, &#39;A&#39;, &#39;Bb&#39;,
                  &#39;B&#39;)
&quot;&quot;&quot;tuple: Chromatic notes names using flats.

A mapping of the chromatic note names using flats.&quot;&quot;&quot;

KEYS = (&#39;C&#39;, &#39;C#&#39;, &#39;Db&#39;, &#39;D&#39;, &#39;D#&#39;, &#39;Eb&#39;, &#39;E&#39;, &#39;F&#39;, &#39;F#&#39;, &#39;Gb&#39;, &#39;G&#39;, &#39;G#&#39;,
        &#39;Ab&#39;, &#39;A&#39;, &#39;A#&#39;, &#39;Bb&#39;, &#39;B&#39;)
&quot;&quot;&quot;tuple: Allowed keys

These are the allowed keys for exercise as comprehended by birdears.&quot;&quot;&quot;

CIRCLE_OF_FIFTHS = [
        (&#39;C&#39;, &#39;G&#39;, &#39;D&#39;, &#39;A&#39;, &#39;E&#39;, &#39;B&#39;, &#39;Gb&#39;, &#39;Db&#39;, &#39;Ab&#39;, &#39;Eb&#39;, &#39;Bb&#39;, &#39;F&#39;),
        (&#39;C&#39;, &#39;F&#39;, &#39;Bb&#39;, &#39;Eb&#39;, &#39;Ab&#39;, &#39;C#&#39;, &#39;F#&#39;, &#39;B&#39;, &#39;E&#39;, &#39;A&#39;, &#39;D&#39;, &#39;G&#39;)
    ]
&quot;&quot;&quot;list of tuples: Circle of fifths.

These are the circle of fifth in both directions.&quot;&quot;&quot;

INTERVALS = (
    (0, &#39;P1&#39;, &#39;Perfect Unison&#39;),
    (1, &#39;m2&#39;, &#39;Minor Second&#39;),
    (2, &#39;M2&#39;, &#39;Major Second&#39;),
    (3, &#39;m3&#39;, &#39;Minor Third&#39;),
    (4, &#39;M3&#39;, &#39;Major Third&#39;),
    (5, &#39;P4&#39;, &#39;Perfect Fourth&#39;),
    (6, &#39;A4&#39;, &#39;Augmented Fourth&#39;),
    (7, &#39;P5&#39;, &#39;Perfect Fifth&#39;),
    (8, &#39;m6&#39;, &#39;Minor Sixth&#39;),
    (9, &#39;M6&#39;, &#39;Major Sixth&#39;),
    (10, &#39;m7&#39;, &#39;Minor Seventh&#39;),
    (11, &#39;M7&#39;, &#39;Major Seventh&#39;),
    (12, &#39;P8&#39;, &#39;Perfect Octave&#39;),
    (13, &#39;A8&#39;, &#39;Minor Ninth&#39;),
    (14, &#39;M9&#39;, &#39;Major Ninth&#39;),
    (15, &#39;m10&#39;, &#39;Minor Tenth&#39;),
    (16, &#39;M10&#39;, &#39;Major Tenth&#39;),
    (17, &#39;P11&#39;, &#39;Perfect Eleventh&#39;),
    (18, &#39;A11&#39;, &#39;Augmented Eleventh&#39;),
    (19, &#39;P12&#39;, &#39;Perfect Twelfth&#39;),
    (20, &#39;m13&#39;, &#39;Minor Thirteenth&#39;),
    (21, &#39;M13&#39;, &#39;Major Thirteenth&#39;),
    (22, &#39;m14&#39;, &#39;Minor Fourteenth&#39;),
    (23, &#39;M14&#39;, &#39;Major Fourteenth&#39;),
    (24, &#39;P15&#39;, &#39;Perfect Double-octave&#39;),
    (25, &#39;A15&#39;, &#39;Minor Sixteenth&#39;),
    (26, &#39;M16&#39;, &#39;Major Sixteenth&#39;),
    (27, &#39;m17&#39;, &#39;Minor Seventeenth&#39;),
    (28, &#39;M17&#39;, &#39;Major Seventeenth&#39;),
    (29, &#39;P18&#39;, &#39;Perfect Eighteenth&#39;),
    (30, &#39;A18&#39;, &#39;Augmented Eighteenth&#39;),
    (31, &#39;P19&#39;, &#39;Perfect Nineteenth&#39;),
    (32, &#39;m20&#39;, &#39;Minor Twentieth&#39;),
    (33, &#39;M20&#39;, &#39;Major Twentieth&#39;),
    (34, &#39;m21&#39;, &#39;Minor Twenty-first&#39;),
    (35, &#39;M21&#39;, &#39;Major Twenty-first&#39;),
    (36, &#39;P22&#39;, &#39;Perfect Triple-octave&#39;)
)
&quot;&quot;&quot;tuple of tuples: Data representing intervals.

A tuple of tuples representing data for the intervals with format
(semitones, short name, full name).&quot;&quot;&quot;

CHROMATIC_TYPE = (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11)
# CHROMATIC_TYPE = (0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12)
&quot;&quot;&quot;tuple: A map of the chromatic scale.

A map of the the semitones which compound the chromatic scale.&quot;&quot;&quot;

TONIC = 0
TONE = 2
SEMITONE = 1

DIATONIC_FORMS = {
    &#39;major&#39;: (TONE, TONE, SEMITONE, TONE, TONE, TONE, SEMITONE),
    &#39;dorian&#39;: (TONE, SEMITONE, TONE, TONE, TONE, SEMITONE, TONE),
    &#39;phrygian&#39;: (SEMITONE, TONE, TONE, TONE, SEMITONE, TONE, TONE),
    &#39;lydian&#39;: (TONE, TONE, TONE, SEMITONE, TONE, TONE, SEMITONE),
    &#39;mixolydian&#39;: (TONE, TONE, SEMITONE, TONE, TONE, SEMITONE, TONE),
    &#39;minor&#39;: (TONE, SEMITONE, TONE, TONE, SEMITONE, TONE, TONE),
    &#39;locrian&#39;: (SEMITONE, TONE, TONE, SEMITONE, TONE, TONE, TONE),
}

DIATONIC_MODES = {
    &#39;major&#39;: (0, 2, 4, 5, 7, 9, 11),
    &#39;dorian&#39;: (0, 2, 3, 5, 7, 9, 10),
    &#39;phrygian&#39;: (0, 1, 3, 5, 7, 8, 10),
    &#39;lydian&#39;: (0, 2, 4, 6, 7, 9, 11),
    &#39;mixolydian&#39;: (0, 2, 4, 5, 7, 9, 10),
    &#39;minor&#39;: (0, 2, 3, 5, 7, 8, 10),
    &#39;locrian&#39;: (0, 1, 3, 5, 6, 8, 10),
}

# DIATONIC_MODES = {
#    &#39;major&#39;: (0, 2, 4, 5, 7, 9, 11, 12),
#    &#39;dorian&#39;: (0, 2, 3, 5, 7, 9, 10, 12),
#    &#39;phrygian&#39;: (0, 1, 3, 5, 7, 8, 10, 12),
#    &#39;lydian&#39;: (0, 2, 4, 6, 7, 9, 11, 12),
#    &#39;mixolydian&#39;: (0, 2, 4, 5, 7, 9, 10, 12),
#    &#39;minor&#39;: (0, 2, 3, 5, 7, 8, 10, 12),
#    &#39;locrian&#39;: (0, 1, 3, 5, 6, 8, 10, 12),
# }

DIATONIC_MASK = {
    &#39;major&#39;: (1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1),
    &#39;dorian&#39;: (1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0),
    &#39;phrygian&#39;: (1, 1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0),
    &#39;lydian&#39;: (1, 0, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1),
    &#39;mixolydian&#39;: (1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 1, 0),
    &#39;minor&#39;: (1, 0, 1, 1, 0, 1, 0, 1, 1, 0, 1, 0),
    &#39;locrian&#39;: (1, 1, 0, 1, 0, 1, 1, 0, 1, 0, 1, 0),
}

# TODO: maybe DIATONIC_MODES could use binary notation or TONE-SEMITONE
# notation, eg:
#
# binary:
#
#   &#39;major&#39;: (1, 0, 1, 0, 1,1,0,1,0,1,0,1,1)
#   or:
#   &#39;major&#39;: &#39;1010110101011&#39;
#
# tone-semitone:
#
#   &#39;major&#39;: (2,2,1,2,2,2,1)
#   or:
#   TONE = 2
#   SEMITONE = 1
#   &#39;major&#39;: (TONE, TONE, SEMITONE, TONE, TONE, TONE, SEMITONE)
# this way we can iterare and just sum up the Pitches&#39; pitch_numbers

&quot;&quot;&quot;dict of tuples: A map of the diatonic scale.

A mapping of the semitones which compound each of the greek modes.
&quot;&quot;&quot;

INTERVAL_INDEX = {
    1: [0],
    2: [1, 2],
    3: [3, 4],
    4: [5, 6],
    5: [6, 7],
    6: [8, 9],
    7: [10, 11],
    8: [12]
}
&quot;&quot;&quot;dict of lists: A mapping of semitones of each interval.

A mapping of semitones which index to each interval name, major/minor,
perfect, augmented/diminished&quot;&quot;&quot;

DEGREE_INDEX = {
    &#39;i&#39;: [0],
    &#39;ii&#39;: [1, 2],
    &#39;iii&#39;: [3, 4],
    &#39;iv&#39;: [5, 6],
    &#39;v&#39;: [6, 7],
    &#39;vi&#39;: [8, 9],
    &#39;vii&#39;: [10, 11],
    &#39;viii&#39;: [12]
}
&quot;&quot;&quot;dict of lists: A mapping of semitones of each degree.

A mapping of semitones which index to each degree roman numeral, major/minor,
perfect, augmented/diminished&quot;&quot;&quot;


# MAJOR keyboard keys (with chromatics)
# keyindex for major and chromatic major context
#  s d   g h j        IIb  IIIb       Vb VIb  VIIb
# z x c v b n m  &lt;-  I   II   III  IV   V   VI   VII
#
#  -- SHIFT meaning an octave higher

# MINOR keyboard keys (with chromatics)
# keyindex for minor and chromatic minor context
#
#  s   f g   j k   eg.:      a#   c# d#    f# g#
# z x c v b n m    -------  a  b c  d  e  f  g


# it is better if this is made progamatically
# note that all diatonic are in keys zxcvvbnm, and uppercase
KEYBOARD_INDICES = {
    &#39;diatonic&#39;: {
        &#39;ascending&#39;: {
            &#39;minor&#39;: &#39;z xc v bn m Z XC V BN M,&#39;,
            &#39;major&#39;: &#39;z x cv b n mZ X CV B NM,&#39;
        },
        # FIXME
        &#39;descending&#39;: {
            &#39;minor&#39;: &#39;z xc v bn m Z XC V BN M,&#39;,
            &#39;major&#39;: &#39;z x cv b n mZ X CV B NM,&#39;
        },
    },
    &#39;chromatic&#39;: {
        &#39;ascending&#39;: {
            &#39;major&#39;:      &quot;zsxdcvgbhnjm,SXDCVGBHNJMZ&quot;,
            &#39;dorian&#39;:     &quot;zsxcfvgbhnmk,SXCFVGBHNMKZ&quot;,
            &#39;phrygian&#39;:   &quot;zxdcfvgbnjmk,XDCFVGBNJMKZ&quot;,
            &#39;lydian&#39;:     &quot;zsxdcfvbhnjm,SXDCFVBHNJMZ&quot;,
            &#39;mixolydian&#39;: &quot;zsxdcvgbhnmk,SXDCVGBHNMNZ&quot;,
            &#39;minor&#39;:      &quot;zsxcfvgbnjmk,SXCFVGBNJMKZ&quot;,
            &#39;locrian&#39;:    &quot;zxdcfvbhnjmk,XDCFVBHNJMKZ&quot;,
        },
        &#39;descending&#39;: {
            &#39;major&#39;:      &quot;,mjnhbgvcdxszMJNHBGVCDXSZ&quot;,
            &#39;dorian&#39;:     &quot;,kmnhbgvfcxszKMNHBGVFCXSZ&quot;,
            &#39;dorian&#39;:     &quot;,kmnhbgvfcxszKMNHBGVFCXSZ&quot;,
            &#39;phrygian&#39;:   &quot;,kmjnbgvfcdxzKMJNBGVFCDXZ&quot;,
            &#39;lydian&#39;:     &quot;,mjnhbvfcdxszMJNHBVFCDXSZ&quot;,
            &#39;mixolydian&#39;: &quot;,kmnhbgvcdxszKMNHBGVCDXSZ&quot;,
            &#39;minor&#39;:      &quot;,kmjnbgvfcxszKMJNBGVFCXSZ&quot;,
            &#39;locrian&#39;:    &quot;,kmjnhbvfcdxzKMJNHBVFCDXZ&quot;,
        }
    }
}

# how many steps to resolve on tonic,
# after which resolves on tonic octave
# (begins on 0 as it is an index)
# 5 is tritone; then
# [0 1 2 3 4 5] resolves below (tonic)
# and [6 7 8 9 10 11] resolves above (octave)

MAX_SEMITONES_RESOLVE_BELOW = 5


# http://code.activestate.com/recipes/134892/
class _Getch:
    &quot;&quot;&quot;Gets a single character from standard input.  Does not echo to the
screen.&quot;&quot;&quot;

    def __init__(self):
        try:
            self.impl = _GetchWindows()
        except ImportError:
            self.impl = _GetchUnix()

    def __call__(self): return self.impl()


class _GetchUnix:
    def __init__(self):
        import tty
        import sys

    def __call__(self):
        import sys
        import tty
        import termios
        fd = sys.stdin.fileno()
        old_settings = termios.tcgetattr(fd)
        try:
            tty.setraw(sys.stdin.fileno())
            ch = sys.stdin.read(1)
        finally:
            termios.tcsetattr(fd, termios.TCSADRAIN, old_settings)
        return ch


class _GetchWindows:
    def __init__(self):
        import msvcrt

    def __call__(self):
        import msvcrt
        return msvcrt.getch()
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2018, Iacchus Mercurius.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>